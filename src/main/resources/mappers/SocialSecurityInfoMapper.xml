<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.shenzhen.recurit.dao.SocialSecurityInfoMapper">

        <resultMap id="baseResultMap" type="com.shenzhen.recurit.pojo.SocialSecurityInfoPojo">
            <id column="id" property="id"/>
            <result column="city_id" property="cityId"/>
            <result column="apply_name" property="applyName"/>
            <result column="id_card" property="idCard"/>
            <result column="positive_id_card" property="positiveIdCard"/>
            <result column="reverse_id_card" property="reverseIdCard"/>
            <result column="phone" property="phone"/>
            <result column="domicile" property="domicile"/>
            <result column="nature_regist" property="natureRegist"/>
            <result column="cardinality" property="cardinality"/>
            <result column="social_security_date" property="socialSecurityDate"/>
            <result column="fee_package_ids" property="feePackageIds"/>
            <result column="status" property="status"/>
            <result column="order_info_id" property="orderInfoId"/>
            <result column="create_date" property="createDate"/>
            <result column="update_date" property="updateDate"/>
            <result column="creater" property="creater"/>
            <result column="updater" property="updater"/>
            <result column="amount" property="amount"/>
        </resultMap>

        <sql id="baseResult">
            city_id,apply_name,id_card,positive_id_card,reverse_id_card,phone,
            domicile,nature_regist,cardinality,social_security_date,fee_package_ids,
            create_date,update_date,creater,updater,order_info_id
        </sql>

        <insert id="saveSocialSecurityInfo" keyColumn="id" useGeneratedKeys="true" keyProperty="id">
            insert into tab_social_security_info(<include refid="baseResult"/>)
                values(#{cityId},#{applyName},#{idCard},
                #{positiveIdCard},#{reverseIdCard},#{phone},
                #{domicile},#{natureRegist},#{cardinality},
                #{socialSecurityDate},#{feePackageIds},
                #{createDate},#{updateDate},#{creater},#{updater},#{orderInfoId})
        </insert>
    
        <update id="updateSocialSecuritInfo">
            update tab_social_security_info
                <set>

                    <if test="cityId != null and cityId != 0">
                        city_id = #{cityId},
                    </if>
                    <if test="applyName != null and applyName != ''">
                        apply_name = #{applyName},
                    </if>
                    <if test="idCard != null and idCard != ''">
                        id_card = #{idCard},
                    </if>
                    <if test="positiveIdCard != null and positiveIdCard != 0">
                        positive_id_card = #{positiveIdCard},
                    </if>
                    <if test="reverseIdCard != null and reverseIdCard != 0">
                        reverse_id_card = #{reverseIdCard},
                    </if>
                    <if test="phone != null and phone != ''">
                        phone = #{phone},
                    </if>
                    <if test="domicile != null and domicile != ''">
                        domicile = #{domicile},
                    </if>
                    <if test="natureRegist != null and natureRegist != ''">
                        nature_regist = #{natureRegist},
                    </if>
                    <if test="cardinality != null and cardinality != 0">
                        cardinality = #{cardinality},
                    </if>
                    <if test="socialSecurityDate != null">
                        social_security_date = #{socialSecurityDate},
                    </if>
                    <if test="feePackageIds != null and feePackageIds != ''">
                        fee_package_ids = #{feePackageIds},
                    </if>
                    <if test="orderInfoId != null and orderInfoId != 0">
                        order_info_id = #{orderInfoId},
                    </if>
                    update_date=#{updateDate},
                    updater=#{updater}
                </set>
        </update>

        <select id="getSocialSecuritInfoById" resultMap="baseResultMap">
            select id,status,<include refid="baseResult"/> from tab_social_security_info where id=#{id} and status =1
        </select>

        <update id="deleteSecuritInfoById">
            update tab_social_security_info set status=2 where id=#{id}
        </update>

        <select id="getAllSocialSecuritInfoByIds" resultMap="baseResultMap">
            select id,status,<include refid="baseResult"/> from tab_social_security_info where  status =1
                id in
                <foreach collection="ids" item="id" open="(" close=")" separator=",">
                    #{id}
                </foreach>
        </select>

        <update id="batchUpdateSocialSecuritInfo">
            update tab_social_security_info set order_info_id =#{orderInfoId}
            where id in
            <foreach collection="ids" item="id" open="(" close=")" separator=",">
                #{id}
            </foreach>
        </update>

        <update id="deleteByOrderInfoId">
            update tab_social_security_info set status=2 where order_info_id=#{orderInfoId}
        </update>

        <select id="getAllSecuritInfo"  resultMap="baseResultMap">
            select id,status,<include refid="baseResult"/> from tab_social_security_info where  user_code=#{userCode}
                and status =1 and 1 > order_info_id
        </select>

        <update id="batchRemoveOrderInfoIds">
            update tab_social_security_info set order_info_id=0
            where id in
            <foreach collection="ids" item="id" open="(" close=")" separator=",">
                #{id}
            </foreach>
        </update>

        <select id="getAllSecuritInfoByOrderInfoId"  resultMap="baseResultMap">
            select id,status,<include refid="baseResult"/> from tab_social_security_info where   order_info_id = #{orderInfoId} and status =1
        </select>

        <select id="getAllSecuritInfoByIdCard" resultMap="baseResultMap">
            select id,status,<include refid="baseResult"/> from tab_social_security_info where   id_card = #{idCard} and status =1
        </select>


</mapper>
