<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.shenzhen.recurit.dao.PositionMapper">

        <resultMap id="baseResultMap" type="com.shenzhen.recurit.pojo.PositionPojo">
            <id column="id" property="id"/>
            <result column="salary" property="salary"/>
            <result column="education" property="education"/>
            <result column="experience" property="experience"/>
            <result column="company_code" property="companyCode"/>
            <result column="sex_req" property="sexReq"/>
            <result column="position_name" property="positionName"/>
            <result column="position_city" property="positionCity"/>
            <result column="status" property="status"/>
            <result column="creater" property="creater"/>
            <result column="updater" property="updater"/>
            <result column="create_date" property="createDate"/>
            <result column="update_date" property="updateDate"/>
            <result column="user_code" property="userCode"/>
            <result column="description" property="description"/>
            <result column="skill_requirement" property="skillRequirement"/>
        </resultMap>

        <sql id="baseResult">
            salary,education,experience,company_code,sex_req,position_name,position_city,position_address,
            creater,updater,create_date,update_date,user_code,description,skill_requirement
        </sql>

        <insert id="savePosition" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
            insert into tab_position(<include refid="baseResult"/>)
                values(#{salary},#{education},#{experience},
                #{companyCode},#{sexReq},#{positionName},#{positionCity},#{creater},#{updater},
                #{createDate},#{updateDate},#{userCode},#{description},#{skillRequirement})
        </insert>

        <select id="getByCompanyCode" resultMap="baseResultMap">
            select id,status,<include refid="baseResult"/> from tab_position
                where company_code = #{companyCode} and  user_code = #{userCode} and status = 1
        </select>

        <select id="getByPositionId" resultMap="baseResultMap">
            select id,status,<include refid="baseResult"/> from tab_position where id = #{id} and status = 1
        </select>

        <update id="deleteByPositionId">
            update tab_position
            <set>
                status = 2,
                update_date = #{updateDate}
            </set>
                where id = #{id}
        </update>

    <update id="updatePosition">
        update tab_position
        <set>
            <if test="positionName != null and positionName != '' ">
                position_name = #{positionName},
            </if>
            <if test="positionAddress != null and positionAddress != '' ">
                position_address = #{positionAddress},
            </if>
            <if test="positionCity != null and positionCity != '' ">
                position_city = #{positionCity},
            </if>
            <if test="salary != null and salary != '' ">
                salary = #{salary},
            </if>
            <if test="experience != null and experience != '' ">
                experience = #{experience},
            </if>
            <if test="sexReq != null and sexReq != '' ">
                sex_req = #{sexReq},
            </if>
            <if test="userCode != null and userCode != '' ">
                user_code = #{userCode},
            </if>
            <if test="description != null and description != '' ">
                description = #{description},
            </if>
            <if test="skillRequirement != null and skillRequirement != '' ">
                skill_requirement = #{skillRequirement},
            </if>
            <if test="education != null and education != '' ">
                education = #{education},
            </if>
            <if test="status != null and status != '' ">
                status = #{status},
            </if>
            <if test="updater != null and updater != '' ">
                updater = #{updater},
            </if>
            <if test="labels != null and labels != '' ">
                labels = #{labels},
            </if>
            update_date = #{updateDate}
        </set>
        where id = #{id}
    </update>
</mapper>
